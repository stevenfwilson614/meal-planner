<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Meal Planner</title>
</head>
<body>
  <h1>Weekly Meal Planner</h1>
  <div id="planner"></div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbxLvnKMroSEOG0CbxS7SHVf6esduQZWPtu1VAIsYOVDoXy2jnQ3-KF6jjTHh6pQUBmR/exec";

    fetch(API_URL)
      .then(res => res.json())
      .then(data => render(data));

    function render(data) {
      const recipes = data.recipes.slice(1);
      const plan = data.plan.slice(1);
      const planner = document.getElementById("planner");

      plan.forEach(row => {
        const div = document.createElement("div");
        div.innerHTML = `
          <strong>${row[0]} ${row[1]}</strong>
          <button onclick="generate('${row[0]}','${row[1]}')">Generate</button>
          <span id="${row[0]}-${row[1]}"></span>
        `;
        planner.appendChild(div);
      });

      window.generate = function(day, meal) {
        const r = recipes[Math.floor(Math.random() * recipes.length)];
        document.getElementById(`${day}-${meal}`).innerHTML =
          `<a href="${r[2]}" target="_blank">${r[1]}</a>`;
      }
    }
  </script>
</body>
</html>
