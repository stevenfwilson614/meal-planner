<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Weekly Meal Planner</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 16px;
      max-width: 500px;
      margin: auto;
    }
    h1 {
      text-align: center;
    }
    .row {
      border-bottom: 1px solid #ddd;
      padding: 8px 0;
    }
    button {
      margin-left: 8px;
    }
  </style>
</head>
<body>

<h1>Weekly Meal Planner</h1>
<div id="planner">Loading meal planâ€¦</div>


<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxLvnKMroSEOG0CbxS7SHVf6esduQZWPtu1VAIsYOVDoXy2jnQ3-KF6jjTHh6pQUBmR/exec";

fetch(API_URL)
  .then(res => res.json())
  .then(data => init(data))
  .catch(err => {
    document.getElementById("planner").innerText =
      "Error loading data.";
    console.error(err);
  });

function init(data) {
  const recipes = data.recipes.slice(1).map(r => ({
    id: r[0],
    name: r[1],
    url: r[2],
    tags: r[3]
  }));

  const plan = data.plan.slice(1);

  const container = document.getElementById("planner");
  container.innerHTML = "";

  plan.forEach(p => {
    const select = document.createElement("select");
select.innerHTML = `
  <option value="">Any</option>
  <option value="beef">Beef</option>
  <option value="chicken">Chicken</option>
  <option value="vegetarian">Vegetarian</option>
  <option value="pork">Pork</option>
`;

const btn = document.createElement("button");
btn.textContent = "Generate";

btn.onclick = () => {
  const chosenTag = select.value;

  const filtered = chosenTag
    ? recipes.filter(r =>
        r.tags.split(",").map(t => t.trim()).includes(chosenTag)
      )
    : recipes;

  if (filtered.length === 0) {
    span.textContent = "No matching recipes";
    return;
  }

  const r = filtered[Math.floor(Math.random() * filtered.length)];
  span.innerHTML = `<a href="${r.url}" target="_blank">${r.name}</a>`;
};

    };

    div.innerHTML = `<strong>${day} ${meal}</strong>`;
  div.appendChild(select);

    div.appendChild(btn);
    div.appendChild(span);

    container.appendChild(div);
  });
}
</script>

</body>
</html>
