<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Weekly Meal Planner</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 16px;
      max-width: 500px;
      margin: auto;
    }
    h1 {
      text-align: center;
    }
    .row {
      border-bottom: 1px solid #ddd;
      padding: 8px 0;
    }
    button {
      margin-left: 8px;
    }
  </style>
</head>
<body>

<h1>Weekly Meal Planner</h1>
<div id="planner">Loadingâ€¦</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxLvnKMroSEOG0CbxS7SHVf6esduQZWPtu1VAIsYOVDoXy2jnQ3-KF6jjTHh6pQUBmR/exec";

fetch(API_URL)
  .then(res => res.json())
  .then(data => init(data))
  .catch(err => {
    document.getElementById("planner").innerText =
      "Error loading data.";
    console.error(err);
  });

function init(data) {
  const recipes = data.recipes.slice(1).map(r => ({
    id: r[0],
    name: r[1],
    url: r[2],
    tags: r[3]
  }));

  const plan = data.plan.slice(1);

  const container = document.getElementById("planner");
  container.innerHTML = "";

  plan.forEach(p => {
    const day = p[0];
    const meal = p[1];

    const div = document.createElement("div");
    div.className = "row";

    const span = document.createElement("span");
    span.id = `${day}-${meal}`;

    const btn = document.createElement("button");
    btn.textContent = "Generate";
    btn.onclick = () => {
      const r = recipes[Math.floor(Math.random() * recipes.length)];
      span.innerHTML = `<a href="${r.url}" target="_blank">${r.name}</a>`;
    };

    div.innerHTML = `<strong>${day} ${meal}</strong>`;
    div.appendChild(btn);
    div.appendChild(span);

    container.appendChild(div);
  });
}
</script>

</body>
</html>
